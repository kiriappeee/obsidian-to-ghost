{"version":3,"file":"main.js","sourceRoot":"","sources":["main.ts"],"names":[],"mappings":"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","sourcesContent":["import { App, Plugin, PluginSettingTab, Setting, Notice, request, TFile } from 'obsidian';\n\n// Define the settings interface\ninterface GhostPublisherSettings {\n  blogUrl: string;\n  writingFolderPath: string;\n  ghostApiKeyName: string; // New setting\n}\n\n// Define the default settings\nconst DEFAULT_SETTINGS: GhostPublisherSettings = {\n  blogUrl: '',\n  writingFolderPath: 'writing',\n  ghostApiKeyName: 'ghost-admin-api-key', // Default for new setting\n};\n\nexport default class ObsidianToGhostPublisher extends Plugin {\n  settings!: GhostPublisherSettings;\n\n  async onload() {\n    console.log('loading Obsidian to Ghost Publisher plugin');\n\n    // Load settings\n    await this.loadSettings();\n\n    // Add the settings tab\n    this.addSettingTab(new GhostSettingsTab(this.app, this));\n\n    // Add a command to publish to Ghost\n    this.addCommand({\n      id: 'publish-to-ghost',\n      name: 'Publish to Ghost',\n      callback: async () => {\n        const activeFile = this.app.workspace.getActiveFile();\n        if (!activeFile) {\n          new Notice('No active file to publish.');\n          return;\n        }\n\n        if (activeFile.extension !== 'md') {\n          new Notice('Can only publish Markdown files.');\n          return;\n        }\n\n        try {\n          const fileContent = await this.app.vault.read(activeFile);\n          const parts = fileContent.split('---', 3); // Split into [before frontmatter, frontmatter, markdown]\n\n          let frontmatter = '';\n          let markdownContent = fileContent;\n          let title = activeFile.basename; // Default title to filename\n\n          if (parts.length >= 3) {\n            frontmatter = parts[1];\n            markdownContent = parts.slice(2).join('---').trim(); // Join back if there are more '---' in content\n\n            const titleMatch = frontmatter.match(/^title:\\s*(.*)/m);\n            if (titleMatch && titleMatch[1]) {\n              // Remove quotes if present\n              title = titleMatch[1].replace(/^['\"]|['\"]$/g, '').trim();\n            }\n          } else {\n            // No frontmatter found, whole file is markdown content\n            markdownContent = fileContent.trim();\n          }\n\n          const contentSnippet = markdownContent.substring(0, 200) + (markdownContent.length > 200 ? '...' : '');\n\n          new Notice(`Extracted Title: \"${title}\"\\nMarkdown Snippet: \"${contentSnippet}\"`, 15000);\n          console.log('Extracted Title:', title);\n          console.log('Extracted Markdown Content:', markdownContent);\n\n        } catch (error) {\n          console.error('Error extracting file content:', error);\n          new Notice('Error extracting file content. See console for details.', 10000);\n        }\n      },\n    });\n  }\n\n  onunload() {\n    console.log('unloading Obsidian to Ghost Publisher plugin');\n  }\n\n  async loadSettings() {\n    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());\n  }\n\n  async saveSettings() {\n    await this.saveData(this.settings);\n  }\n}\n\nclass GhostSettingsTab extends PluginSettingTab {\n  plugin: ObsidianToGhostPublisher;\n\n  constructor(app: App, plugin: ObsidianToGhostPublisher) {\n    super(app, plugin);\n    this.plugin = plugin;\n  }\n\n  display(): void {\n    const { containerEl } = this;\n\n    containerEl.empty();\n\n    containerEl.createEl('h2', { text: 'Ghost Publisher Settings' });\n\n    new Setting(containerEl)\n      .setName('Blog URL')\n      .setDesc('The public URL of your Ghost blog (e.g., https://myblog.com)')\n      .addText(text => text\n        .setPlaceholder('https://myblog.com')\n        .setValue(this.plugin.settings.blogUrl)\n        .onChange(async (value) => {\n          this.plugin.settings.blogUrl = value;\n          await this.plugin.saveSettings();\n        }));\n\n    new Setting(containerEl)\n      .setName('Writing Folder Path')\n      .setDesc('The path to the root folder containing your drafts and published posts.')\n      .addText(text => text\n        .setPlaceholder('writing')\n        .setValue(this.plugin.settings.writingFolderPath)\n        .onChange(async (value) => {\n          this.plugin.settings.writingFolderPath = value;\n          await this.plugin.saveSettings();\n        }));\n\n    // New Setting for Ghost Admin API Key Secret Name\n    new Setting(containerEl)\n      .setName('Ghost Admin API Key Secret Name')\n      .setDesc('The name of the secret stored in Obsidian\\'s secure storage for your Ghost Admin API Key.')\n      .addText(text => text\n        .setPlaceholder(DEFAULT_SETTINGS.ghostApiKeyName)\n        .setValue(this.plugin.settings.ghostApiKeyName)\n        .onChange(async (value) => {\n          this.plugin.settings.ghostApiKeyName = value;\n          await this.plugin.saveSettings();\n        }));\n  }\n}\n"]}